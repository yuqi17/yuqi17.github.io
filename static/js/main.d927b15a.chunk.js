(this.webpackJsonpmqttreact=this.webpackJsonpmqttreact||[]).push([[0],{126:function(e,t){},139:function(e,t,a){e.exports=a(220)},146:function(e,t,a){},154:function(e,t){},156:function(e,t){},210:function(e,t){},212:function(e,t){},218:function(e,t,a){},220:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(130),l=a.n(o),r=(a(146),a(46)),s=a(225),i=a(222),m=a(223),u=a(227),p=a(226),E=a(224),f=a(136),b=function(e){var t=e.connect,a=e.disconnect,n=e.connectBtn,o=s.a.useForm(),l=Object(r.a)(o,1)[0],b=c.a.createElement(s.a,{layout:"vertical",name:"basic",form:l,initialValues:{protocol:"wss",host:"broker.emqx.io",clientId:"mqttx_27004980",port:8084,username:"jonas",password:"abc123"},onFinish:function(e){var a=e.protocol,n=e.host,c=e.clientId,o=e.port,l=e.username,r=e.password,s="".concat(a,"://").concat(n,":").concat(o,"/mqtt");t(s,{clientId:c,username:l,password:r,clean:!0,reconnectPeriod:1e3,connectTimeout:3e4})}},c.a.createElement(i.a,{gutter:20},c.a.createElement(m.a,{lg:{span:8},sm:{span:24}},c.a.createElement(s.a.Item,{label:"Protocol",name:"protocol"},c.a.createElement(u.a,{onChange:function(e){l.setFieldsValue({port:"wss"===e?8084:8083})}},c.a.createElement(u.a.Option,{value:"ws"},"ws"),c.a.createElement(u.a.Option,{value:"wss"},"wss")))),c.a.createElement(m.a,{lg:{span:8},sm:{span:24}},c.a.createElement(s.a.Item,{label:"Host",name:"host"},c.a.createElement(p.a,null))),c.a.createElement(m.a,{lg:{span:8},sm:{span:24}},c.a.createElement(s.a.Item,{label:"Port",name:"port"},c.a.createElement(p.a,null))),c.a.createElement(m.a,{lg:{span:8},sm:{span:24}},c.a.createElement(s.a.Item,{label:"Client ID",name:"clientId"},c.a.createElement(p.a,null))),c.a.createElement(m.a,{lg:{span:8},sm:{span:24}},c.a.createElement(s.a.Item,{label:"Username",name:"username"},c.a.createElement(p.a,null))),c.a.createElement(m.a,{lg:{span:8},sm:{span:24}},c.a.createElement(s.a.Item,{label:"Password",name:"password"},c.a.createElement(p.a,null)))));return c.a.createElement(E.a,{title:"Connection",actions:[c.a.createElement(f.a,{type:"primary",onClick:function(){l.submit()}},n),c.a.createElement(f.a,{danger:!0,onClick:function(){a()}},"Disconnect")]},b)},d=function(e){var t=e.publish,a=s.a.useForm(),o=Object(r.a)(a,1)[0],l=Object(n.useContext)(y),b=c.a.createElement(s.a,{layout:"vertical",name:"basic",form:o,initialValues:{topic:"switch",qos:0,payload:'{state:"on"}'},onFinish:function(e){t(e)}},c.a.createElement(i.a,{gutter:20},c.a.createElement(m.a,{span:12},c.a.createElement(s.a.Item,{label:"Topic",name:"topic"},c.a.createElement(p.a,null))),c.a.createElement(m.a,{span:12},c.a.createElement(s.a.Item,{label:"QoS",name:"qos"},c.a.createElement(u.a,{options:l}))),c.a.createElement(m.a,{span:24},c.a.createElement(s.a.Item,{label:"Payload",name:"payload"},c.a.createElement(p.a.TextArea,null))),c.a.createElement(m.a,{span:8,offset:16,style:{textAlign:"right"}},c.a.createElement(s.a.Item,null,c.a.createElement(f.a,{type:"primary",htmlType:"submit"},"Publish")))),c.a.createElement(i.a,{gutter:8},c.a.createElement(m.a,null,c.a.createElement(f.a,{type:"danger",onClick:function(){t({topic:"switch",qos:0,payload:'{state:"off"}'})}},"\u5173\u95ed")),c.a.createElement(m.a,null,c.a.createElement(f.a,{type:"primary",onClick:function(){t({topic:"switch",qos:0,payload:'{state:"on"}'})}},"\u5f00\u542f"))));return c.a.createElement(E.a,{title:"Publisher"},b)},g=function(e){var t=e.params,a=void 0===t?{}:t,o=e.unSub,l=s.a.useForm(),b=Object(r.a)(l,1)[0],d=Object(n.useContext)(y),g=c.a.createElement(s.a,{layout:"vertical",name:"basic",form:b,initialValues:a},c.a.createElement(i.a,{gutter:20},c.a.createElement(m.a,{lg:{span:12},sm:{span:24}},c.a.createElement(s.a.Item,{label:"Topic",name:"topic"},c.a.createElement(p.a,null))),c.a.createElement(m.a,{lg:{span:12},sm:{span:24}},c.a.createElement(s.a.Item,{label:"QoS",name:"qos"},c.a.createElement(u.a,{options:d}))),c.a.createElement(m.a,{lg:{span:12},sm:{span:24}},c.a.createElement(s.a.Item,null,c.a.createElement(f.a,{type:"danger",style:{marginLeft:"10px"},onClick:function(){var e=b.getFieldsValue();o(e)}},"Unsubscribe")))));return c.a.createElement(E.a,{title:"Subscriber"},g)},h=a(133),v=a.n(h),w=a(135),y=Object(n.createContext)([]),q=[{label:"0",value:0},{label:"1",value:1},{label:"2",value:2}];function I(e){var t=e.data,a=void 0===t?{}:t;return c.a.createElement("div",{style:{backgroundColor:"#fff",color:"#000",textAlign:"center",fontSize:14,width:"100%",padding:"8px"}},c.a.createElement("span",{style:{marginRight:10}},"\u6e29\u5ea6:","".concat(a.temperature,"\u2103")),c.a.createElement("span",null,"\u6e7f\u5ea6:","".concat(a.humidity,"%")))}var C=function(){var e=Object(n.useState)(null),t=Object(r.a)(e,2),a=t[0],o=t[1],l=Object(n.useState)({humidity:0,temperature:0}),s=Object(r.a)(l,2),i=s[0],m=s[1],u=Object(n.useState)("Connect"),p=Object(r.a)(u,2),E=p[0],f=p[1];Object(n.useEffect)((function(){a&&(a.on("connect",(function(){f("Connected"),w.a.success({message:"connection successful"}),h({topic:"weather",qos:0}),h({topic:"switch/feedback",qos:0})})),a.on("error",(function(e){w.a.error("Connection error! "),console.log(e),a.end()})),a.on("reconnect",(function(){f("Reconnecting")})),a.on("message",(function(e,t){if(console.log("received message: ".concat(t," from topic: ").concat(e)),"weather"==e){var a=JSON.parse("".concat(t));m(a)}else"switch/feedback"==e&&w.a.info({message:"".concat(t)})})))}),[a]);var h=function(e){if(a){var t=e.topic,n=e.qos;a.subscribe(t,{qos:n},(function(e){e?console.log("Subscribe to topics error",e):console.log("Subscribe to topics: ".concat(t))}))}};return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{connect:function(e,t){f("Connecting"),o(v.a.connect(e,t))},disconnect:function(){if(a)try{a.end(!1,(function(){f("Connect"),w.a.success({message:"disconnected successfully"})}))}catch(e){console.log("disconnect error:",e)}},connectBtn:E}),c.a.createElement(I,{data:i}),c.a.createElement(y.Provider,{value:q},c.a.createElement(g,{params:{topic:"weather",qos:0},unSub:function(e){if(a){var t=e.topic,n=e.qos;a.unsubscribe(t,{qos:n},(function(e){e?console.log("Unsubscribe error",e):console.log("unsubscribed topic: ".concat(t))}))}}}),c.a.createElement(d,{publish:function(e){if(a){var t=e.topic,n=e.qos,c=e.payload;a.publish(t,c,{qos:n},(function(e){e&&console.log("Publish error: ",e)}))}}})))};a(218);var O=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(C,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.createRoot(document.getElementById("root")).render(c.a.createElement(O,null)),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[139,1,2]]]);
//# sourceMappingURL=main.d927b15a.chunk.js.map